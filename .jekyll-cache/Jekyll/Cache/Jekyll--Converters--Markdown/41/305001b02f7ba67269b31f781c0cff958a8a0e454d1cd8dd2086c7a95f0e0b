I"b<h4 id="前言">前言</h4>

<p>服务端开发开启<code class="language-plaintext highlighter-rouge">debug</code>接口返回数据会携带<code class="language-plaintext highlighter-rouge">&lt;br...</code>等日志信息影响<code class="language-plaintext highlighter-rouge">iOS</code>数据解析,使用<code class="language-plaintext highlighter-rouge">AFNetWorking</code>直接触发<code class="language-plaintext highlighter-rouge">fail</code>,使用系统原生网络请求可自行做截取处理</p>

<h4 id="原生网络请求截取">原生网络请求截取</h4>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>... 
...

if (!dict) {
    NSString* br_jsonStr = [[NSString alloc] initWithData:data encoding:NSUTF8StringEncoding];
    NSLog(@"出现非标准Json:%@",br_jsonStr);
    if ([br_jsonStr containsString:@"{\"ret\""]) {
        NSRange rangeRes = [br_jsonStr rangeOfString:@"{"];
        //NSLog(@"xxxxx:%lu",(unsigned long)rangeRes.location);
        NSString *newStr = [br_jsonStr substringFromIndex:rangeRes.location];
        NSData *newData = [newStr dataUsingEncoding:NSUTF8StringEncoding];
        dict = [NSJSONSerialization JSONObjectWithData:newData options:NSJSONReadingMutableContainers error:nil];
        NSLog(@"发生截取:%@\n%@\n",url,newStr);
    }
}
</code></pre></div></div>
:ET